#include "mxs_algo.h"

void print_darr(uint16_t *buf, uint16_t len)
{
    for (uint16_t i = 0; i < len; i++)
    {
        printf("[%d]: %d\n", i, buf[i]);
    }
    
}

void print_larr(uint32_t *buf, uint16_t len)
{
    for (uint16_t i = 0; i < len; i++)
    {
        printf("[%d]: %lu\n", i, buf[i]);
    }
    
}

int main(int argc, char const *argv[])
{
    uint32_t data[1001] = {2071,2793,3258,3310,2820,1972,1336,788,737,1273,2000,2631,2957,3048,2786,2045,1228,894,841,1321,2008,2647,2975,2919,2676,2012,1223,715,643,1279,1892,2597,3363,2932,2683,1880,1136,757,1048,1286,1892,2657,3186,3128,2724,1915,1223,581,715,1253,1917,2665,3091,2967,2558,1893,1265,832,641,1354,1900,2912,3049,2892,2483,1890,1210,708,841,1141,1856,2472,2990,3212,2547,1849,1262,613,697,1026,1888,2533,2898,2963,2677,1949,1181,627,631,1084,1948,2738,3163,3047,2553,1779,1016,761,724,971,1806,2321,3085,2869,2538,1764,1113,615,762,1065,1931,2393,2877,2885,2699,1695,984,698,705,1064,1808,2544,2956,2827,2543,1856,1237,615,852,1014,1947,2477,2909,3075,2466,1922,944,731,778,1007,1663,2506,2690,2782,2395,1684,1197,716,500,924,1518,2510,2979,2891,2506,1708,957,585,461,1054,1689,2513,2916,2686,2362,1875,1012,495,534,1132,1754,2450,3063,2765,2446,1738,1010,709,605,1006,1701,2578,2925,2848,2586,1684,884,651,514,1196,1746,2366,2900,3046,2674,1548,1063,748,578,835,1730,2233,2877,2996,2593,1928,1073,710,610,1062,1772,2624,2910,2734,2514,1398,1052,697,603,943,1728,2408,2981,2775,2299,1768,922,564,618,998,1652,2411,2726,2770,2298,1849,983,446,302,1006,1673,2443,2913,2839,2406,1836,939,572,684,1051,1518,2375,2888,2850,2464,1871,1052,574,484,865,1524,2355,2727,2921,2514,1680,968,552,618,1139,1886,2330,2808,2585,2409,1674,1026,531,522,1084,1520,2603,2731,2709,2279,1654,906,421,485,1079,1734,2409,2895,2920,2267,1642,1078,566,590,865,1677,2376,2809,2813,2545,1838,966,579,587,1033,1786,2456,2722,2997,2388,1718,1042,621,538,1136,1907,2314,2715,2787,2367,1834,1035,676,750,863,1629,2163,2992,2900,2557,1631,1060,749,541,919,1771,2472,2938,2916,2537,1937,1295,526,634,1078,1931,2303,2723,2878,2466,1742,1030,706,492,1110,1824,2470,3048,2956,2553,1912,1161,560,472,1058,1692,2503,2905,3076,2524,1795,1128,407,776,1303,1908,2432,2984,2872,2502,1863,1185,577,632,1175,1919,2404,2883,2954,2329,1710,1029,621,590,998,1770,2546,2952,2892,2539,1632,1089,556,562,1236,1694,2731,2993,3047,2490,1838,1122,634,792,1235,1839,2590,2945,3006,2507,1827,1183,726,650,1223,1924,2474,3009,3134,2489,1892,1182,815,904,1208,1929,2539,2959,2982,2540,1906,1330,709,690,775,1909,2642,2970,3110,2583,1871,1303,886,720,1211,1714,2684,3007,2957,2661,2097,1140,856,919,1261,1828,2641,2960,2954,2563,1927,1194,903,784,1218,2093,2632,3056,2943,2726,1962,1239,808,752,1109,1891,2507,3039,3158,2604,1996,1364,850,785,1279,1834,2658,3186,3033,2703,2165,1344,943,1024,1357,2079,2750,3174,3200,2766,1983,1357,897,819,1392,1879,2751,3220,3131,2926,1906,1336,817,923,1411,2196,2690,3338,3319,2724,1885,1502,781,683,1514,2108,2794,3118,3085,2892,2223,1416,824,1029,1486,2141,2782,3269,3289,2927,2189,1446,1009,922,1422,2037,2916,3205,3039,2779,2274,1521,745,987,1350,2154,3063,3249,3232,2940,2023,1464,1133,895,1520,2222,2933,3251,3112,2894,2194,1560,1093,965,1350,2050,2853,3373,3220,2853,2143,1430,983,1195,1389,2006,2705,3167,3395,2990,2182,1505,956,1061,1617,2049,2665,3298,3353,2872,2165,1585,1149,1037,1333,2170,2981,3473,3420,2987,2324,1624,958,946,1558,2167,2993,3544,3274,2867,2123,1540,1032,1006,1497,2279,2755,3555,3348,3024,2175,1413,1062,1189,1744,2476,2952,3567,3495,3125,2151,1507,1206,955,1597,2327,2808,3436,3275,3045,2382,1564,1197,1136,1611,2226,3049,3418,3430,2861,2174,1747,933,1045,1590,2261,2982,3474,3454,3146,2461,1488,1160,1136,1598,2326,2989,3325,3363,3163,2278,1544,1244,1143,1538,2290,2935,3301,3315,3015,2245,1739,938,1005,1380,2378,2933,3426,3441,3160,2316,1561,1163,1217,1815,2082,2951,3333,3444,2995,2335,1298,1159,1197,1513,2316,3072,3405,3673,3023,2307,1481,1069,1288,1540,2230,3063,3426,3481,3058,2340,1521,1100,1207,1351,2321,2947,3453,3469,3049,2208,1517,1199,1430,1535,2355,2926,3596,3384,3066,2314,1672,972,1029,1480,2225,2848,3265,3354,3019,2401,1498,1141,1075,1415,2307,2941,3619,3512,3246,2434,1519,1095,1104,1558,2366,3021,3530,3564,2887,2303,1569,1141,1263,1761,2215,3044,3496,3578,3132,2262,1610,1078,1142,1399,2183,2983,3457,3483,2911,2506,1660,1141,1255,1559,2152,2903,3293,3415,2909,2350,1562,993,1007,1670,2113,2969,3406,3524,2867,2217,1668,1206,1086,1670,2229,2851,3480,3353,3098,2278,1522,1188,1022,1465,2204,3077,3502,3183,2972,2339,1418,890,998,1400,2300,2730,3217,3284,2988,2116,1372,857,1116,1643,2046,2955,3158,3402,2847,2278,1577,1068,1063,1472,2267,2865,3219,3265,2850,1961,1583,1188,1002,1568,2132,2877,3379,3388,2965,1988,1485,1018,1023,1288,2225,2854,3375,3266,2958,2180,1522,1051,1033,1623,2267,2821,3184,3213,2736,2112,1400,1130,920,1539,2247,2985,3300,3318,2608,2162,1260,1047,936,1419,2045,2714,3358,3345,2795,2073,1364,1025,1056,1375,2096,2918,3051,3069,2793,2105,1414,1127,1118,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,3673,1961};
    
    uint16_t peakLocs[1001] = {0};
    uint32_t peakMags[1001] = {0};
    uint16_t nPeaks;
    
    nPeaks = peakfinder(data, 1001, peakLocs, peakMags);

    uint32_t maxval;
    uint16_t maxind;

    arrmax(peakMags, nPeaks, &maxval, &maxind);

    printf("max value %lu at %d", maxval, peakLocs[maxind]);
    // print_larr(peakMags, nPeaks);

    return 0;
}
